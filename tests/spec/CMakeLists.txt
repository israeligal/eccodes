# check gridspec from GRIB samples
macro(add_test_spec arg regex)
    string(MAKE_C_IDENTIFIER "eccodes_tests_spec_${arg}_${regex}" _target)
    ecbuild_add_test(TARGET ${_target} COMMAND grib_get_gridspec ARGS ${arg} WORKING_DIRECTORY ${CMAKE_CURRENT_SOURCE_DIR}/../../samples)
    set_tests_properties(${_target} PROPERTIES PASS_REGULAR_EXPRESSION ${regex})
    unset(_target)
endmacro()



add_test_spec(GRIB1.tmpl                             [=[{"grid":[1,1]}]=])
add_test_spec(GRIB2.tmpl                             [=[{"grid":[2,2],"shape":[16,31]}]=])
add_test_spec(ccsds_grib2.tmpl                       [=[{"grid":[2,2],"shape":[16,31]}]=])
add_test_spec(clusters_grib1.tmpl                    [=[{"grid":[1.5,1.5]}]=])
add_test_spec(destine_grib2.tmpl                     [=[{"grid":[2,2],"shape":[16,31]}]=])
add_test_spec(gg_sfc_grib1.tmpl                      [=[{"grid":"N48"}]=])
add_test_spec(gg_sfc_grib2.tmpl                      [=[{"grid":"N48"}]=])
# add_test_spec(lambert_bf_grib2.tmpl                  NOTIMP)
# add_test_spec(polar_stereographic_pl_grib1.tmpl      NOTIMP)
# add_test_spec(polar_stereographic_pl_grib2.tmpl      NOTIMP)
# add_test_spec(polar_stereographic_sfc_grib1.tmpl     NOTIMP)
# add_test_spec(polar_stereographic_sfc_grib2.tmpl     NOTIMP)
add_test_spec(reduced_gg_ml_grib1.tmpl               [=[{"grid":"N32"}]=])
add_test_spec(reduced_gg_ml_grib2.tmpl               [=[{"grid":"N32"}]=])
add_test_spec(reduced_gg_pl_32_grib1.tmpl            [=[{"grid":"N32"}]=])
add_test_spec(reduced_gg_pl_32_grib2.tmpl            [=[{"grid":"N32"}]=])
add_test_spec(reduced_gg_pl_48_grib1.tmpl            [=[{"grid":"N48"}]=])
add_test_spec(reduced_gg_pl_48_grib2.tmpl            [=[{"grid":"N48"}]=])
add_test_spec(reduced_gg_pl_64_grib1.tmpl            [=[{"grid":"N64"}]=])
add_test_spec(reduced_gg_pl_64_grib2.tmpl            [=[{"grid":"N64"}]=])
add_test_spec(reduced_gg_pl_80_grib1.tmpl            [=[{"grid":"N80"}]=])
add_test_spec(reduced_gg_pl_80_grib2.tmpl            [=[{"grid":"N80"}]=])
add_test_spec(reduced_gg_pl_96_grib1.tmpl            [=[{"grid":"N96"}]=])
add_test_spec(reduced_gg_pl_96_grib2.tmpl            [=[{"grid":"N96"}]=])
add_test_spec(reduced_gg_pl_128_grib1.tmpl           [=[{"grid":"N128"}]=])
add_test_spec(reduced_gg_pl_128_grib2.tmpl           [=[{"grid":"N128"}]=])
add_test_spec(reduced_gg_pl_160_grib1.tmpl           [=[{"grid":"N160"}]=])
add_test_spec(reduced_gg_pl_160_grib2.tmpl           [=[{"grid":"N160"}]=])
add_test_spec(reduced_gg_pl_200_grib1.tmpl           [=[{"grid":"N200"}]=])
add_test_spec(reduced_gg_pl_200_grib2.tmpl           [=[{"grid":"N200"}]=])
add_test_spec(reduced_gg_pl_256_grib1.tmpl           [=[{"grid":"N256"}]=])
add_test_spec(reduced_gg_pl_256_grib2.tmpl           [=[{"grid":"N256"}]=])
add_test_spec(reduced_gg_pl_320_grib1.tmpl           [=[{"grid":"N320"}]=])
add_test_spec(reduced_gg_pl_320_grib2.tmpl           [=[{"grid":"N320"}]=])
add_test_spec(reduced_gg_pl_400_grib1.tmpl           [=[{"grid":"N400"}]=])
add_test_spec(reduced_gg_pl_400_grib2.tmpl           [=[{"grid":"N400"}]=])
add_test_spec(reduced_gg_pl_512_grib1.tmpl           [=[{"grid":"N512"}]=])
add_test_spec(reduced_gg_pl_512_grib2.tmpl           [=[{"grid":"N512"}]=])
add_test_spec(reduced_gg_pl_640_grib1.tmpl           [=[{"grid":"N640"}]=])
add_test_spec(reduced_gg_pl_640_grib2.tmpl           [=[{"grid":"N640"}]=])
add_test_spec(reduced_gg_pl_1024_grib1.tmpl          [=[{"grid":"N1024"}]=])
add_test_spec(reduced_gg_pl_1024_grib2.tmpl          [=[{"grid":"N1024"}]=])
add_test_spec(reduced_gg_pl_1280_grib1.tmpl          [=[{"grid":"N1280"}]=])
add_test_spec(reduced_gg_pl_1280_grib2.tmpl          [=[{"grid":"N1280"}]=])
add_test_spec(reduced_gg_pl_2000_grib1.tmpl          [=[{"grid":"N2000"}]=])
add_test_spec(reduced_gg_pl_2000_grib2.tmpl          [=[{"grid":"N2000"}]=])
add_test_spec(reduced_gg_pl_grib1.tmpl               [=[{"grid":"N32"}]=])
add_test_spec(reduced_gg_pl_grib2.tmpl               [=[{"grid":"N32"}]=])
add_test_spec(reduced_gg_sfc_grib1.tmpl              [=[{"grid":"N32"}]=])
add_test_spec(reduced_gg_sfc_grib2.tmpl              [=[{"grid":"N32"}]=])
add_test_spec(reduced_gg_sfc_jpeg_grib2.tmpl         [=[{"grid":"N32"}]=])
# add_test_spec(reduced_ll_sfc_grib1.tmpl              NOTIMP)
# add_test_spec(reduced_ll_sfc_grib2.tmpl              NOTIMP)
add_test_spec(reduced_rotated_gg_ml_grib1.tmpl       [=[{"grid":"N32","rotation":[0,0]}]=])
add_test_spec(reduced_rotated_gg_ml_grib2.tmpl       [=[{"grid":"N32","rotation":[0,0]}]=])
add_test_spec(reduced_rotated_gg_pl_32_grib1.tmpl    [=[{"grid":"N32","rotation":[0,0]}]=])
add_test_spec(reduced_rotated_gg_pl_32_grib2.tmpl    [=[{"grid":"N32","rotation":[0,0]}]=])
add_test_spec(reduced_rotated_gg_pl_48_grib1.tmpl    [=[{"grid":"N48","rotation":[0,0]}]=])
add_test_spec(reduced_rotated_gg_pl_48_grib2.tmpl    [=[{"grid":"N48","rotation":[0,0]}]=])
add_test_spec(reduced_rotated_gg_pl_80_grib1.tmpl    [=[{"grid":"N80","rotation":[0,0]}]=])
add_test_spec(reduced_rotated_gg_pl_80_grib2.tmpl    [=[{"grid":"N80","rotation":[0,0]}]=])
add_test_spec(reduced_rotated_gg_pl_96_grib1.tmpl    [=[{"grid":"N96","rotation":[0,0]}]=])
add_test_spec(reduced_rotated_gg_pl_96_grib2.tmpl    [=[{"grid":"N96","rotation":[0,0]}]=])
add_test_spec(reduced_rotated_gg_pl_128_grib1.tmpl   [=[{"grid":"N128","rotation":[0,0]}]=])
add_test_spec(reduced_rotated_gg_pl_128_grib2.tmpl   [=[{"grid":"N128","rotation":[0,0]}]=])
add_test_spec(reduced_rotated_gg_pl_160_grib1.tmpl   [=[{"grid":"N160","rotation":[0,0]}]=])
add_test_spec(reduced_rotated_gg_pl_160_grib2.tmpl   [=[{"grid":"N160","rotation":[0,0]}]=])
add_test_spec(reduced_rotated_gg_pl_200_grib1.tmpl   [=[{"grid":"N200","rotation":[0,0]}]=])
add_test_spec(reduced_rotated_gg_pl_200_grib2.tmpl   [=[{"grid":"N200","rotation":[0,0]}]=])
add_test_spec(reduced_rotated_gg_pl_256_grib1.tmpl   [=[{"grid":"N256","rotation":[0,0]}]=])
add_test_spec(reduced_rotated_gg_pl_256_grib2.tmpl   [=[{"grid":"N256","rotation":[0,0]}]=])
add_test_spec(reduced_rotated_gg_pl_320_grib1.tmpl   [=[{"grid":"N320","rotation":[0,0]}]=])
add_test_spec(reduced_rotated_gg_pl_320_grib2.tmpl   [=[{"grid":"N320","rotation":[0,0]}]=])
add_test_spec(reduced_rotated_gg_pl_400_grib1.tmpl   [=[{"grid":"N400","rotation":[0,0]}]=])
add_test_spec(reduced_rotated_gg_pl_400_grib2.tmpl   [=[{"grid":"N400","rotation":[0,0]}]=])
add_test_spec(reduced_rotated_gg_pl_512_grib1.tmpl   [=[{"grid":"N512","rotation":[0,0]}]=])
add_test_spec(reduced_rotated_gg_pl_512_grib2.tmpl   [=[{"grid":"N512","rotation":[0,0]}]=])
add_test_spec(reduced_rotated_gg_pl_640_grib1.tmpl   [=[{"grid":"N640","rotation":[0,0]}]=])
add_test_spec(reduced_rotated_gg_pl_640_grib2.tmpl   [=[{"grid":"N640","rotation":[0,0]}]=])
add_test_spec(reduced_rotated_gg_pl_1024_grib1.tmpl  [=[{"grid":"N1024","rotation":[0,0]}]=])
add_test_spec(reduced_rotated_gg_pl_1024_grib2.tmpl  [=[{"grid":"N1024","rotation":[0,0]}]=])
add_test_spec(reduced_rotated_gg_pl_1280_grib1.tmpl  [=[{"grid":"N1280","rotation":[0,0]}]=])
add_test_spec(reduced_rotated_gg_pl_1280_grib2.tmpl  [=[{"grid":"N1280","rotation":[0,0]}]=])
add_test_spec(reduced_rotated_gg_pl_2000_grib1.tmpl  [=[{"grid":"N2000","rotation":[0,0]}]=])
add_test_spec(reduced_rotated_gg_pl_2000_grib2.tmpl  [=[{"grid":"N2000","rotation":[0,0]}]=])
add_test_spec(reduced_rotated_gg_pl_grib1.tmpl       [=[{"grid":"N32","rotation":[0,0]}]=])
add_test_spec(reduced_rotated_gg_pl_grib2.tmpl       [=[{"grid":"N32","rotation":[0,0]}]=])
add_test_spec(reduced_rotated_gg_sfc_grib1.tmpl      [=[{"grid":"N32","rotation":[0,0]}]=])
add_test_spec(reduced_rotated_gg_sfc_grib2.tmpl      [=[{"grid":"N32","rotation":[0,0]}]=])
add_test_spec(reduced_rotated_gg_sfc_jpeg_grib2.tmpl [=[{"grid":"N32","rotation":[0,0]}]=])
add_test_spec(regular_gg_ml_grib1.tmpl               [=[{"grid":"F32"}]=])
add_test_spec(regular_gg_ml_grib2.tmpl               [=[{"grid":"F32"}]=])
add_test_spec(regular_gg_pl_grib1.tmpl               [=[{"grid":"F32"}]=])
add_test_spec(regular_gg_pl_grib2.tmpl               [=[{"grid":"F32"}]=])
add_test_spec(regular_gg_sfc_grib1.tmpl              [=[{"grid":"F32"}]=])
add_test_spec(regular_gg_sfc_grib2.tmpl              [=[{"grid":"F32"}]=])
add_test_spec(regular_ll_pl_grib1.tmpl               [=[{"grid":[2,2],"shape":[16,31]}]=])
add_test_spec(regular_ll_pl_grib2.tmpl               [=[{"grid":[2,2],"shape":[16,31]}]=])
add_test_spec(regular_ll_sfc_grib1.tmpl              [=[{"grid":[2,2],"shape":[16,31]}]=])
add_test_spec(regular_ll_sfc_grib2.tmpl              [=[{"grid":[2,2],"shape":[16,31]}]=])
add_test_spec(rotated_gg_ml_grib1.tmpl               [=[{"grid":"F32","rotation":[0,0]}]=])
add_test_spec(rotated_gg_ml_grib2.tmpl               [=[{"grid":"F32","rotation":[0,0]}]=])
add_test_spec(rotated_gg_pl_grib1.tmpl               [=[{"grid":"F32","rotation":[0,0]}]=])
add_test_spec(rotated_gg_pl_grib2.tmpl               [=[{"grid":"F32","rotation":[0,0]}]=])
add_test_spec(rotated_gg_sfc_grib1.tmpl              [=[{"grid":"F32","rotation":[0,0]}]=])
add_test_spec(rotated_gg_sfc_grib2.tmpl              [=[{"grid":"F32","rotation":[0,0]}]=])
add_test_spec(rotated_ll_pl_grib1.tmpl               [=[{"area":"bounding-box","bounding-box":[60,0,0,30],"grid":[2,2],"rotation":[0,0],"shape":[16,31]}]=])
add_test_spec(rotated_ll_pl_grib2.tmpl               [=[{"area":"bounding-box","bounding-box":[60,0,0,30],"grid":[2,2],"rotation":[0,0],"shape":[16,31]}]=])
add_test_spec(rotated_ll_sfc_grib1.tmpl              [=[{"area":"bounding-box","bounding-box":[60,0,0,30],"grid":[2,2],"rotation":[0,0],"shape":[16,31]}]=])
add_test_spec(rotated_ll_sfc_grib2.tmpl              [=[{"area":"bounding-box","bounding-box":[60,0,0,30],"grid":[2,2],"rotation":[0,0],"shape":[16,31]}]=])

unset(add_test_spec)
